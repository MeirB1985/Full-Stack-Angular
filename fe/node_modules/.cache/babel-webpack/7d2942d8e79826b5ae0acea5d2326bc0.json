{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/Desktop/FullStack/JB/ThirdProject/fe/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { environment } from 'src/environments/environment';\nimport ProductModel from '../models/product.model';\nimport { productAddedAction, productDeletedAction, productsDownloadedAction, productEditedAction } from '../redux/products-state';\nimport store from '../redux/store';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ProductsService {\n  constructor(http) {\n    this.http = http;\n  } // Get all products: \n\n\n  getAllProducts() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (store.getState().productsState.products.length === 0) {\n        const products = yield _this.http.get(environment.productsUrl).toPromise();\n        store.dispatch(productsDownloadedAction(products));\n      }\n\n      return store.getState().productsState.products;\n    })();\n  } // Get one product: \n\n\n  getOneProduct(id) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      if (store.getState().productsState.products.length === 0) {\n        const products = yield _this2.http.get(environment.productsUrl).toPromise();\n        store.dispatch(productsDownloadedAction(products));\n      }\n\n      const product = store.getState().productsState.products.find(p => p._id === id);\n      return product;\n    })();\n  } // Add product: \n\n\n  addProduct(product) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const myFormData = ProductModel.convertToFormData(product);\n      const addedProduct = yield _this3.http.post(environment.productsUrl, myFormData).toPromise();\n      store.dispatch(productAddedAction(addedProduct));\n      return addedProduct;\n    })();\n  } // Update product: \n\n\n  editProduct(product) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      console.log(\"here\");\n      const myFormData = ProductModel.convertToFormData(product);\n      console.log(product);\n      console.log(product.categoryToSend);\n      const editedProduct = yield _this4.http.put(environment.adminUrl + product._id, myFormData).toPromise();\n      console.log(editedProduct);\n      store.dispatch(productEditedAction(editedProduct));\n      return editedProduct;\n    })();\n  } // Delete product: \n\n\n  deleteProduct(id) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this5.http.delete(environment.productsUrl + id).toPromise();\n      store.dispatch(productDeletedAction(id));\n    })();\n  }\n\n}\n\nProductsService.ɵfac = function ProductsService_Factory(t) {\n  return new (t || ProductsService)(i0.ɵɵinject(i1.HttpClient));\n};\n\nProductsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ProductsService,\n  factory: ProductsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["C:\\Users\\user\\Desktop\\FullStack\\JB\\ThirdProject\\fe\\src\\app\\services\\products.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { environment } from 'src/environments/environment';\nimport ProductModel from '../models/product.model';\nimport { productAddedAction, productDeletedAction, productsDownloadedAction, productEditedAction } from '../redux/products-state';\nimport store from '../redux/store';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ProductsService {\n\n    constructor(private http: HttpClient) { }\n\n    // Get all products: \n    public async getAllProducts() {\n        if (store.getState().productsState.products.length === 0) {\n            const products = await this.http.get<ProductModel[]>(environment.productsUrl).toPromise();\n            store.dispatch(productsDownloadedAction(products));\n        }\n        return store.getState().productsState.products;\n    }\n\n    // Get one product: \n    public async getOneProduct(id: string) {\n        if (store.getState().productsState.products.length === 0) {\n            const products = await this.http.get<ProductModel[]>(environment.productsUrl).toPromise();\n            store.dispatch(productsDownloadedAction(products));\n        }\n        const product = store.getState().productsState.products.find(p => p._id === id);\n        return product;\n    }\n\n    // Add product: \n    public async addProduct(product: ProductModel) {\n        const myFormData: FormData = ProductModel.convertToFormData(product);\n        const addedProduct = await this.http.post<ProductModel>(environment.productsUrl, myFormData).toPromise();\n        store.dispatch(productAddedAction(addedProduct));\n        return addedProduct;\n    }\n\n    // Update product: \n    public async editProduct(product: ProductModel) {\n        console.log(\"here\");\n        const myFormData: FormData = ProductModel.convertToFormData(product);\n        console.log(product);\n        console.log(product.categoryToSend);\n        const editedProduct = await this.http.put<ProductModel>(environment.adminUrl + product._id, myFormData).toPromise();\n        console.log(editedProduct);\n        store.dispatch(productEditedAction(editedProduct));\n        return editedProduct;\n    }\n\n    // Delete product: \n    public async deleteProduct(id: string) {\n        await this.http.delete(environment.productsUrl + id).toPromise();\n        store.dispatch(productDeletedAction(id));\n    }\n\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}