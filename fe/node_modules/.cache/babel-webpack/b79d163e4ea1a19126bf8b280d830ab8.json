{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/Desktop/FullStack/JB/Third Project/fe/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport store from 'src/app/redux/store';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/carts.service\";\nimport * as i2 from \"src/app/services/items.service\";\nimport * as i3 from \"src/app/services/products.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"../../items-area/item-card/item-card.component\";\n\nfunction MyCartComponent_app_item_card_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-item-card\", 6);\n  }\n\n  if (rf & 2) {\n    const i_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"item\", i_r1);\n  }\n}\n\nexport class MyCartComponent {\n  constructor(myCartsService, myItemsService, myProductsService, myRouter) {\n    this.myCartsService = myCartsService;\n    this.myItemsService = myItemsService;\n    this.myProductsService = myProductsService;\n    this.myRouter = myRouter;\n    this.totalPrice = 0;\n    this.imageUrl = environment.productImagesUrl;\n    this.sum = 0;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // this.unsubscribeMe = store.subscribe(() => {\n      _this.user = store.getState().authState.user; // });\n\n      try {\n        _this.products = yield _this.myProductsService.getAllProducts();\n      } catch (err) {\n        console.log(\"err user products-check if neccessery\");\n      }\n\n      try {\n        _this.carts = yield _this.myCartsService.getAllCarts(_this.user._id);\n      } catch (err) {\n        console.log(\"err getting user carts\");\n      }\n\n      if (_this.carts === undefined) {\n        console.log(\"no carts\");\n      } else {\n        _this.lastCartIndex = _this.carts.length - 1;\n\n        try {\n          _this.items = yield _this.myItemsService.getAllItems(_this.carts[_this.lastCartIndex]._id);\n        } catch (err) {\n          console.log(\"err getting user items\");\n        } // }\n\n      } // console.log(this.items);\n\n\n      _this.totalPrice = _this.getTotalPrice();\n\n      if (_this.items.length >= 1) {\n        _this.isCartEmpty = false;\n      } else {\n        _this.isCartEmpty = true;\n      }\n    })();\n  }\n\n  getTotalPrice() {\n    let total = 0;\n\n    for (let item of this.items) {\n      total += item.price;\n    }\n\n    return total;\n  } // ngOnDestroy(): void {\n  //     this.unsubscribeMe();\n  // }\n\n\n  deleteAll() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        yield _this2.myItemsService.deleteAll();\n        console.log(\"items has been deleted\");\n      } catch (err) {\n        console.log(err);\n      }\n    })();\n  }\n\n  isEmpty() {\n    //   console.log(this.items);\n    // if (this.isCartEmpty = false) {\n    //   this.isCartEmpty = false;\n    // } else {\n    //   this.isCartEmpty = true;\n    // }\n    return this.isCartEmpty;\n  }\n\n  makeOrder() {\n    this.myRouter.navigateByUrl(\"/orders/new\");\n  }\n\n}\n\nMyCartComponent.ɵfac = function MyCartComponent_Factory(t) {\n  return new (t || MyCartComponent)(i0.ɵɵdirectiveInject(i1.CartsService), i0.ɵɵdirectiveInject(i2.ItemsService), i0.ɵɵdirectiveInject(i3.ProductsService), i0.ɵɵdirectiveInject(i4.Router));\n};\n\nMyCartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MyCartComponent,\n  selectors: [[\"app-my-cart\"]],\n  decls: 14,\n  vars: 3,\n  consts: [[1, \"main\"], [1, \"top\"], [\"mat-raised-button\", \"\", 3, \"item\", 4, \"ngFor\", \"ngForOf\"], [1, \"buttom\"], [\"mat-button\", \"\", 3, \"disabled\", \"click\"], [\"mat-button\", \"\", 3, \"click\"], [\"mat-raised-button\", \"\", 3, \"item\"]],\n  template: function MyCartComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"h3\");\n      i0.ɵɵtext(3, \"My Cart\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(4, \"hr\");\n      i0.ɵɵtemplate(5, MyCartComponent_app_item_card_5_Template, 1, 1, \"app-item-card\", 2);\n      i0.ɵɵelement(6, \"br\");\n      i0.ɵɵelementStart(7, \"div\", 3);\n      i0.ɵɵelementStart(8, \"p\");\n      i0.ɵɵtext(9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"button\", 4);\n      i0.ɵɵlistener(\"click\", function MyCartComponent_Template_button_click_10_listener() {\n        return ctx.makeOrder();\n      });\n      i0.ɵɵtext(11, \"Make an order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function MyCartComponent_Template_button_click_12_listener() {\n        return ctx.deleteAll();\n      });\n      i0.ɵɵtext(13, \"Delete All\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.items);\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate1(\"Total: \", ctx.totalPrice, \"\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", ctx.isEmpty());\n    }\n  },\n  directives: [i5.NgForOf, i6.MatButton, i7.ItemCardComponent],\n  styles: [\".buttom[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    text-align: left;\\r\\n}\\r\\n\\r\\n.main[_ngcontent-%COMP%] {\\r\\n    position: absolute;\\r\\n    width: 40%;\\r\\n    height: 100%;\\r\\n    padding: 5px;\\r\\n    \\r\\n    text-overflow: clip;\\r\\n    background-color: rgb(205, 220, 247);\\r\\n}\\r\\n\\r\\nbutton[_ngcontent-%COMP%] {\\r\\n    align-items: right;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm15LWNhcnQuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWE7SUFDYixtQkFBbUI7SUFDbkIsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksa0JBQWtCO0lBQ2xCLFVBQVU7SUFDVixZQUFZO0lBQ1osWUFBWTtJQUNaLGlCQUFpQjtJQUNqQixtQkFBbUI7SUFDbkIsb0NBQW9DO0FBQ3hDOztBQUVBO0lBQ0ksa0JBQWtCO0FBQ3RCIiwiZmlsZSI6Im15LWNhcnQuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5idXR0b20ge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XHJcbiAgICB0ZXh0LWFsaWduOiBsZWZ0O1xyXG59XHJcblxyXG4ubWFpbiB7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB3aWR0aDogNDAlO1xyXG4gICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgcGFkZGluZzogNXB4O1xyXG4gICAgLyogbWFyZ2luOiA1cHg7ICovXHJcbiAgICB0ZXh0LW92ZXJmbG93OiBjbGlwO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDIwNSwgMjIwLCAyNDcpO1xyXG59XHJcblxyXG5idXR0b24ge1xyXG4gICAgYWxpZ24taXRlbXM6IHJpZ2h0O1xyXG59Il19 */\"]\n});","map":{"version":3,"sources":["C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\cart-area\\my-cart\\my-cart.component.ts","C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\cart-area\\my-cart\\my-cart.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Unsubscribe } from 'redux';\nimport CartModel from 'src/app/models/cart.model';\nimport ItemModel from 'src/app/models/item.model';\nimport OrderModel from 'src/app/models/order.model';\nimport ProductModel from 'src/app/models/product.model';\nimport UserModel from 'src/app/models/user.model';\nimport store from 'src/app/redux/store';\nimport { CartsService } from 'src/app/services/carts.service';\nimport { ItemsService } from 'src/app/services/items.service';\nimport { ProductsService } from 'src/app/services/products.service';\nimport { environment } from 'src/environments/environment';\n\n@Component({\n  selector: 'app-my-cart',\n  templateUrl: './my-cart.component.html',\n  styleUrls: ['./my-cart.component.css']\n})\nexport class MyCartComponent implements OnInit {\n\n  public totalPrice: number =0;\n  public user: UserModel;\n  public items: ItemModel[];\n  public item: ItemModel;\n  public products: ProductModel[];\n  public product: ProductModel;\n  private unsubscribeMe: Unsubscribe;\n  public imageUrl = environment.productImagesUrl;\n  private carts: CartModel[];\n  public cart: CartModel;\n  private lastCartIndex: number;\n  public order: OrderModel;\n  public sum = 0;\n  public isCartEmpty: boolean;\n\n  constructor(\n    private myCartsService: CartsService,\n    private myItemsService: ItemsService,\n    private myProductsService: ProductsService,\n    private myRouter: Router\n    ) { }\n\n  async ngOnInit() {\n    // this.unsubscribeMe = store.subscribe(() => {\n    this.user = store.getState().authState.user;\n    // });\n    try {\n      this.products = await this.myProductsService.getAllProducts();\n    }\n    catch (err) {\n        console.log(\"err user products-check if neccessery\");\n    }\n    try {\n      this.carts = await this.myCartsService.getAllCarts(this.user._id);\n    }\n    catch (err) {\n      console.log(\"err getting user carts\");\n    }\n    if (this.carts === undefined) {\n      console.log(\"no carts\");\n    } else {\n      this.lastCartIndex = this.carts.length - 1;\n      \n        try {\n          this.items = await this.myItemsService.getAllItems(this.carts[this.lastCartIndex]._id);\n        }\n        catch (err) {\n          console.log(\"err getting user items\");\n        }\n      // }\n    }\n    // console.log(this.items);\n    this.totalPrice = this.getTotalPrice();\n\n    if (this.items.length >= 1) {\n      this.isCartEmpty = false;\n    } else {\n      this.isCartEmpty = true;\n    }\n  }\n\n  getTotalPrice(): number {\n    let total: number = 0;\n    for (let item of this.items) {\n      total += item.price;\n    }\n    return total;\n  }\n\n  // ngOnDestroy(): void {\n  //     this.unsubscribeMe();\n  // }\n\n  async deleteAll() {\n    try {\n      await this.myItemsService.deleteAll();\n      console.log(\"items has been deleted\");\n    }\n    catch(err) {\n        console.log(err);\n    }\n  }\n\n  public isEmpty() {\n  //   console.log(this.items);\n    // if (this.isCartEmpty = false) {\n    //   this.isCartEmpty = false;\n    // } else {\n    //   this.isCartEmpty = true;\n    // }\n    return this.isCartEmpty;\n  }\n\n  makeOrder() {\n    this.myRouter.navigateByUrl(\"/orders/new\");\n  }\n}\n","<div class=\"main\">\n    <div class=\"top\">\n        <h3>My Cart</h3>\n    </div>\n    <hr/>\n    <app-item-card mat-raised-button *ngFor=\"let i of items\" [item]=\"i\"></app-item-card>\n    <br/>\n    <div class=\"buttom\">\n        <p>Total: {{totalPrice}}</p>\n        <button mat-button (click)=\"makeOrder()\" [disabled]=\"isEmpty()\">Make an order</button>\n        <button mat-button (click)=\"deleteAll()\">Delete All</button>\n    </div>\n</div>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}