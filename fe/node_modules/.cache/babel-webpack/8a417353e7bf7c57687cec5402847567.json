{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/Desktop/FullStack/JB/Third Project/fe/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport store from 'src/app/redux/store';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/carts.service\";\nimport * as i2 from \"src/app/services/orders.service\";\nimport * as i3 from \"src/app/services/items.service\";\nimport * as i4 from \"../../auth-area/login/login.component\";\nimport * as i5 from \"../inventory/inventory.component\";\nimport * as i6 from \"@angular/common\";\n\nfunction HomeComponent_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"h4\");\n    i0.ɵɵtext(2, \"Welcome to our website\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction HomeComponent_ng_container_14_h4_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\");\n    i0.ɵɵtext(1, \"Welcome to your first shopping\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction HomeComponent_ng_container_14_h4_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"You have open cart from \", ctx_r3.openCartDate, \"\");\n  }\n}\n\nfunction HomeComponent_ng_container_14_h4_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total price \", i0.ɵɵpipeBind2(2, 1, ctx_r4.totalPrice, \"ILS\"), \"\");\n  }\n}\n\nfunction HomeComponent_ng_container_14_h4_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Your last order was on \", ctx_r5.lastOrderDate, \"\");\n  }\n}\n\nfunction HomeComponent_ng_container_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"h3\");\n    i0.ɵɵtext(2, \"Notifications:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h3\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, HomeComponent_ng_container_14_h4_5_Template, 2, 0, \"h4\", 3);\n    i0.ɵɵtemplate(6, HomeComponent_ng_container_14_h4_6_Template, 2, 1, \"h4\", 3);\n    i0.ɵɵtemplate(7, HomeComponent_ng_container_14_h4_7_Template, 3, 4, \"h4\", 3);\n    i0.ɵɵtemplate(8, HomeComponent_ng_container_14_h4_8_Template, 2, 1, \"h4\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\"Hello \", ctx_r1.user.firstName, \" \", ctx_r1.user.lastName, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.carts);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.carts && ctx_r1.lastCartId !== ctx_r1.lastOrderCartId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.carts && ctx_r1.lastCartId !== ctx_r1.lastOrderCartId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.carts && ctx_r1.lastCartId === ctx_r1.lastOrderCartId);\n  }\n}\n\nexport class HomeComponent {\n  constructor(myCartsService, myOrdersService, myItemsService) {\n    this.myCartsService = myCartsService;\n    this.myOrdersService = myOrdersService;\n    this.myItemsService = myItemsService;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // this.unsubscribeMe = store.subscribe(async () => {\n      _this.user = store.getState().authState.user;\n\n      if (_this.user === null) {\n        console.log(\"no user\");\n      } else if (_this.user !== null && _this.user.admin === true) {\n        console.log(\"admin\");\n      } else {\n        try {\n          _this.carts = yield _this.myCartsService.getAllCarts(_this.user._id);\n        } catch (err) {\n          console.log(\"no carts\");\n        }\n\n        if (_this.carts === null) {\n          console.log(_this.carts); // this.openCartDate = null;\n        } else {\n          _this.lastCartIndex = _this.carts.length - 1;\n\n          try {\n            _this.orders = yield _this.myOrdersService.getAllUserOrders(_this.user._id);\n          } catch (err) {\n            console.log(\"problem getting order\");\n          }\n\n          _this.lastCartId = _this.carts[_this.lastCartIndex]._id;\n          console.log(\"last cart id: \" + _this.lastCartId);\n\n          if (_this.orders === null) {\n            // we have a cart but no orders-means that this cart is open\n            _this.openCartDate = _this.carts[_this.lastCartIndex].date.toLocaleString();\n          } else {\n            // we have cart's and order's\n            _this.lastOrderIndex = _this.orders.length - 1;\n            _this.lastOrderCartId = _this.orders[_this.lastOrderIndex].cart._id;\n            console.log(\"last order cart id: \" + _this.lastOrderCartId); // check if theirs an order on last cart\n\n            if (_this.lastCartId === _this.lastOrderCartId) {\n              // if id's are the same-means that this cart is closed-get last order date\n              _this.lastOrderDate = _this.orders[_this.lastOrderIndex].orderDate;\n              console.log(_this.lastOrderDate);\n            } else {\n              // when id's are different-means that there is an open cart\n              _this.openCartDate = _this.carts[_this.lastCartIndex].date.toLocaleString();\n            }\n          }\n        }\n\n        try {\n          _this.items = yield _this.myItemsService.getAllItems(_this.carts[_this.lastCartIndex]._id);\n        } catch (err) {\n          console.log(\"no items\");\n        }\n\n        _this.totalPrice = _this.getTotalPrice();\n      } // });\n\n    })();\n  }\n\n  getTotalPrice() {\n    let total = 0;\n\n    for (let item of this.items) {\n      total += item.price;\n    }\n\n    return total;\n  }\n\n  ngOnDestroy() {\n    this.unsubscribeMe();\n  }\n\n}\n\nHomeComponent.ɵfac = function HomeComponent_Factory(t) {\n  return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.CartsService), i0.ɵɵdirectiveInject(i2.OrdersService), i0.ɵɵdirectiveInject(i3.ItemsService));\n};\n\nHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HomeComponent,\n  selectors: [[\"app-home\"]],\n  inputs: {\n    totalPrice: \"totalPrice\"\n  },\n  decls: 15,\n  vars: 2,\n  consts: [[1, \"column\"], [\"src\", \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSlTxho4ctAuGF119v5lR4Qe1Xfj7l13gg7Cw&usqp=CAU\"], [\"src\", \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS7dDKtuHUE7xlhlA9fjmVYt9K43CmXuo67NA&usqp=CAU\"], [4, \"ngIf\"]],\n  template: function HomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"span\", 0);\n      i0.ɵɵelementStart(1, \"div\");\n      i0.ɵɵelement(2, \"app-login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\");\n      i0.ɵɵelementStart(4, \"h3\");\n      i0.ɵɵtext(5, \"Why should you buy in our store?\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"h3\");\n      i0.ɵɵtext(7, \"Best price! Best service!\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(8, \"img\", 1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"div\");\n      i0.ɵɵelement(10, \"img\", 2);\n      i0.ɵɵelement(11, \"br\");\n      i0.ɵɵelement(12, \"app-inventory\");\n      i0.ɵɵtemplate(13, HomeComponent_ng_container_13_Template, 3, 0, \"ng-container\", 3);\n      i0.ɵɵtemplate(14, HomeComponent_ng_container_14_Template, 9, 6, \"ng-container\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"ngIf\", !ctx.user);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.user && ctx.user.admin === false);\n    }\n  },\n  directives: [i4.LoginComponent, i5.InventoryComponent, i6.NgIf],\n  pipes: [i6.CurrencyPipe],\n  styles: [\"div[_ngcontent-%COMP%] {\\r\\n    display: inline-block;\\r\\n    text-align: center;\\r\\n    width: 800px;\\r\\n    \\r\\n    \\r\\n    border: 1px solid black;\\r\\n    padding: 0 10px;\\r\\n    \\r\\n    \\r\\n    \\r\\n}\\r\\n\\r\\nimg[_ngcontent-%COMP%] {\\r\\n    margin: 10px;\\r\\n}\\r\\n\\r\\n.column[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    padding-bottom: 20px;\\r\\n}\\r\\n\\r\\nh4[_ngcontent-%COMP%] {\\r\\n    background-color: yellow;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvbWUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLHFCQUFxQjtJQUNyQixrQkFBa0I7SUFDbEIsWUFBWTtJQUNaLGlCQUFpQjtJQUNqQiw0QkFBNEI7SUFDNUIsdUJBQXVCO0lBQ3ZCLGVBQWU7SUFDZixpQkFBaUI7SUFDakIseUJBQXlCO0lBQ3pCLDhCQUE4QjtBQUNsQzs7QUFFQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxhQUFhO0lBQ2Isb0JBQW9CO0FBQ3hCOztBQUVBO0lBQ0ksd0JBQXdCO0FBQzVCIiwiZmlsZSI6ImhvbWUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbImRpdiB7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICB3aWR0aDogODAwcHg7XHJcbiAgICAvKiBmbG9hdDogbGVmdDsgKi9cclxuICAgIC8qIGJveC1zaXppbmc6IGJvcmRlci1ib3g7ICovXHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcclxuICAgIHBhZGRpbmc6IDAgMTBweDtcclxuICAgIC8qIG1hcmdpbjogNXB4OyAqL1xyXG4gICAgLyogYm9yZGVyLXJhZGl1czogMTBweDsgKi9cclxuICAgIC8qIGJveC1zaGFkb3c6IDVweCA1cHggMTBweDsgKi9cclxufVxyXG5cclxuaW1nIHtcclxuICAgIG1hcmdpbjogMTBweDtcclxufVxyXG5cclxuLmNvbHVtbiB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgcGFkZGluZy1ib3R0b206IDIwcHg7XHJcbn1cclxuXHJcbmg0IHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHllbGxvdztcclxufVxyXG4iXX0= */\"]\n});","map":{"version":3,"sources":["C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\home-area\\home\\home.component.ts","C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\home-area\\home\\home.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input } from '@angular/core';\nimport { Unsubscribe } from 'redux';\nimport store from 'src/app/redux/store';\nimport UserModel from 'src/app/models/user.model';\nimport CartModel from 'src/app/models/cart.model';\nimport OrderModel from 'src/app/models/order.model';\nimport { CartsService } from 'src/app/services/carts.service';\nimport { OrdersService } from 'src/app/services/orders.service';\nimport { ItemsService } from 'src/app/services/items.service';\nimport ItemModel from 'src/app/models/item.model';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.component.html',\n  styleUrls: ['./home.component.css']\n})\n\nexport class HomeComponent {\n\n  @Input()\n  public totalPrice: number;\n\n  public user: UserModel;\n  private unsubscribeMe: Unsubscribe;\n  public openCartDate: string;\n  public lastOrderDate: string;\n  public lastOrderIndex: number;\n  public lastOrderDate2: string;\n  public lastCartIndex: number;\n  public orders: OrderModel[];\n  public carts: CartModel[];\n  public items: ItemModel[];\n  public lastCartId: string;\n  public lastOrderCartId: string;\n\n  constructor(\n    private myCartsService: CartsService,\n    private myOrdersService: OrdersService,\n    private myItemsService: ItemsService\n    ) { }\n\n  async ngOnInit() {\n    // this.unsubscribeMe = store.subscribe(async () => {\n      this.user = store.getState().authState.user;\n      if (this.user === null) {\n        console.log(\"no user\");\n      } else if (this.user !== null && this.user.admin === true ) {\n        console.log(\"admin\");\n      } else {\n        try {\n            this.carts = await this.myCartsService.getAllCarts(this.user._id);\n        }\n        catch (err) {\n            console.log(\"no carts\");\n        }\n        if (this.carts === null) {\n          console.log(this.carts);\n          // this.openCartDate = null;\n        } else {\n          this.lastCartIndex = this.carts.length-1;\n          try {\n            this.orders = await this.myOrdersService.getAllUserOrders(this.user._id);\n          }\n          catch (err) {\n            console.log(\"problem getting order\");\n          }\n          this.lastCartId = this.carts[this.lastCartIndex]._id;\n          console.log(\"last cart id: \" + this.lastCartId);\n          if (this.orders === null) {\n            // we have a cart but no orders-means that this cart is open\n            this.openCartDate = this.carts[this.lastCartIndex].date.toLocaleString();\n          } else {\n            // we have cart's and order's\n            this.lastOrderIndex = this.orders.length-1;\n            this.lastOrderCartId = this.orders[this.lastOrderIndex].cart._id;\n            console.log(\"last order cart id: \" + this.lastOrderCartId);\n            // check if theirs an order on last cart\n            if (this.lastCartId === this.lastOrderCartId) {\n              // if id's are the same-means that this cart is closed-get last order date\n              this.lastOrderDate = this.orders[this.lastOrderIndex].orderDate;\n              console.log(this.lastOrderDate);\n            } else {\n              // when id's are different-means that there is an open cart\n              this.openCartDate = this.carts[this.lastCartIndex].date.toLocaleString();\n            }\n          }\n        }\n        try {\n          this.items = await this.myItemsService.getAllItems(this.carts[this.lastCartIndex]._id);\n        }\n        catch (err) {\n          console.log(\"no items\");\n        }\n        this.totalPrice = this.getTotalPrice();\n      }\n    // });\n  }\n\n  getTotalPrice(): number {\n    let total: number =0;\n    for (let item of this.items) {\n     total += item.price;\n   }\n   return total;\n}\n\n  ngOnDestroy(): void {\n      this.unsubscribeMe();\n  }\n}\n","<span class=\"column\">\n    <div>\n        <app-login></app-login>\n    </div>\n    <div>\n        <h3>Why should you buy in our store?</h3>\n        <h3>Best price! Best service!</h3>\n        <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSlTxho4ctAuGF119v5lR4Qe1Xfj7l13gg7Cw&usqp=CAU\"/>\n    </div>\n    <div>\n        <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS7dDKtuHUE7xlhlA9fjmVYt9K43CmXuo67NA&usqp=CAU\"/>\n        <br/>\n        <app-inventory></app-inventory>\n\n        <ng-container *ngIf=\"!user\">\n            <h4>Welcome to our website</h4>\n        </ng-container>\n        <ng-container *ngIf=\"user && user.admin===false\">\n            <h3>Notifications:</h3>\n            <h3 >Hello {{user.firstName}} {{user.lastName}}</h3>\n            <h4 *ngIf=\"!carts\">Welcome to your first shopping</h4>\n            <h4 *ngIf=\"carts && lastCartId !== lastOrderCartId\">You have open cart from {{openCartDate}}</h4>\n            <h4 *ngIf=\"carts && lastCartId !== lastOrderCartId\">Total price {{totalPrice | currency:\"ILS\"}}</h4>\n            <h4 *ngIf=\"carts && lastCartId === lastOrderCartId\">Your last order was on {{lastOrderDate}}</h4>\n        </ng-container>\n    </div>\n</span>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}