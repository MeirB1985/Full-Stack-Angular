{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/Desktop/FullStack/JB/Third Project/fe/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport OrderModel from 'src/app/models/order.model';\nimport store from 'src/app/redux/store';\nimport { DialogComponent } from '../dialog/dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/carts.service\";\nimport * as i2 from \"src/app/services/orders.service\";\nimport * as i3 from \"src/app/services/items.service\";\nimport * as i4 from \"src/app/services/notify.service\";\nimport * as i5 from \"@angular/material/dialog\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"../receipt/receipt.component\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/material/form-field\";\nimport * as i10 from \"@angular/material/input\";\nimport * as i11 from \"@angular/common\";\nimport * as i12 from \"@angular/material/datepicker\";\nimport * as i13 from \"@angular/material/button\";\nimport * as i14 from \"@angular/material/icon\";\n\nfunction MyOrderComponent_mat_error_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing city.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MyOrderComponent_mat_error_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing street.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MyOrderComponent_mat_error_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing shipping date.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MyOrderComponent_mat_error_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing credit card number.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MyOrderComponent_mat_error_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"This is not a valid credit card\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class MyOrderComponent {\n  constructor(myCartsService, myOrdersService, myItemsService, notify, dialog, myRouter) {\n    this.myCartsService = myCartsService;\n    this.myOrdersService = myOrdersService;\n    this.myItemsService = myItemsService;\n    this.notify = notify;\n    this.dialog = dialog;\n    this.myRouter = myRouter;\n    this.order = new OrderModel();\n    this.today = new Date();\n\n    this.myFilter = d => {\n      const day = (d || new Date()).getDay();\n      return day !== 5 && day !== 6;\n    };\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    this.unsubscribeMe = store.subscribe( /*#__PURE__*/_asyncToGenerator(function* () {\n      _this.user = store.getState().authState.user;\n\n      try {\n        _this.carts = yield _this.myCartsService.getAllCarts(_this.user._id);\n      } catch (err) {\n        _this.notify.error(\"err getting user carts\");\n      }\n\n      try {\n        _this.orders = yield _this.myOrdersService.getAllOrders();\n      } catch (err) {\n        _this.notify.error(\"err getting user carts\");\n      }\n\n      const takenShippinDate = _this.orders.count([{\n        \"$group\": {\n          \"order\": \"$shippingDate\",\n          \"count\": {\n            \"$sum\": 3\n          }\n        }\n      }]); // console.log(takenShippinDate);\n\n    }));\n  }\n\n  ngOnDestroy() {\n    this.unsubscribeMe();\n  }\n\n  getUsersCity() {\n    this.order.city = this.user.city;\n  }\n\n  getUsersSt() {\n    // this.user = store.getState().authState.user;\n    this.order.st = this.user.st;\n  } // counldnt find the right validation for future date only\n  // async dateValidation() {\n  // const myFilter = (d: Date | null): boolean => {\n  // const takenShippinDate = this.orders.count(o.shippingDate === 3);\n  // const day = (d || new Date()).getDay();\n  // Prevent Saturday and Sunday from being selected.\n  // return day !== 5 && day !== 6 && day !== takenShippinDate;\n  // public disabledDates = (date: Date): boolean => {\n  // return date.getDate() % 2 === 0;\n  // };\n  // };\n  // try {\n  //   this.orders = await this.myOrdersService.getAllOrders();\n  // }\n  // catch (err) {\n  //     this.notify.error(err);\n  // }\n  // const takenShippinDate = this.orders.count(o.shippingDate === 3);\n  // \n  // let picker = (d: Date | null): boolean => {\n  //   const day = (d || new Date()).getDay();\n  //   // Prevent Saturday and Sunday from being selected.\n  //   return day !== 0 && day !== 6;\n  // };\n  // }\n  // doesn work\n\n\n  cardValidation() {\n    const cardRegEx = '/^(?:4[0-9]{12}(?:[0-9]{3})?)$/ || /^(?:5[1-5][0-9]{14})$/ || /^(?:3[47][0-9]{13})$/ || /^(?:6(?:011|5[0-9][0-9])[0-9]{12})$/';\n\n    if (this.order.card !== cardRegEx) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  makeOrder() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.user = store.getState().authState.user;\n\n      try {\n        _this2.carts = yield _this2.myCartsService.getAllCarts(_this2.user._id);\n        console.log(_this2.carts);\n      } catch (err) {\n        _this2.notify.error(\"err getting user carts-order page\");\n      }\n\n      _this2.order.user = _this2.user;\n      _this2.lastCartIndex = _this2.carts.length - 1;\n\n      try {\n        _this2.items = yield _this2.myItemsService.getAllItems(_this2.carts[_this2.lastCartIndex]._id);\n      } catch (err) {\n        _this2.notify.error(\"err getting user carts\");\n      }\n\n      _this2.order.cart = _this2.carts[_this2.lastCartIndex];\n\n      for (let item of _this2.items) {\n        _this2.totalPrice += item.price;\n      }\n\n      _this2.order.price = 2000;\n      _this2.order.orderDate = new Date().toLocaleDateString();\n      console.log(_this2.order.orderDate);\n      _this2.order.card = _this2.order.card.toString();\n\n      try {\n        _this2.order = yield _this2.myOrdersService.addOrder(_this2.order);\n        _this2.order.card = _this2.order.card.substring(_this2.order.card.length - 4);\n      } catch (err) {\n        _this2.notify.error(\"problem creating order\");\n      }\n\n      console.log(_this2.order);\n      _this2.dialogRef = _this2.dialog.open(DialogComponent, {\n        data: {\n          invoice: _this2.cart\n        }\n      });\n\n      _this2.dialogRef.afterClosed().subscribe(result => {\n        console.log('The dialog was closed');\n\n        _this2.myRouter.navigateByUrl(\"/home\");\n\n        _this2.result = result;\n      });\n    })();\n  }\n\n}\n\nMyOrderComponent.ɵfac = function MyOrderComponent_Factory(t) {\n  return new (t || MyOrderComponent)(i0.ɵɵdirectiveInject(i1.CartsService), i0.ɵɵdirectiveInject(i2.OrdersService), i0.ɵɵdirectiveInject(i3.ItemsService), i0.ɵɵdirectiveInject(i4.NotifyService), i0.ɵɵdirectiveInject(i5.MatDialog), i0.ɵɵdirectiveInject(i6.Router));\n};\n\nMyOrderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MyOrderComponent,\n  selectors: [[\"app-my-order\"]],\n  decls: 45,\n  vars: 14,\n  consts: [[\"calss\", \"main\"], [1, \"cart\"], [1, \"order\"], [3, \"submit\"], [\"myForm\", \"ngForm\"], [\"appearance\", \"fill\"], [\"matInput\", \"\", \"type\", \"text\", \"name\", \"city\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"dblclick\"], [\"cityBox\", \"ngModel\"], [4, \"ngIf\"], [\"matInput\", \"\", \"type\", \"text\", \"name\", \"st\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"dblclick\"], [\"stBox\", \"ngModel\"], [\"matInput\", \"\", \"name\", \"shippingDate\", \"required\", \"\", 3, \"matDatepickerFilter\", \"matDatepicker\", \"min\", \"ngModel\", \"ngModelChange\"], [\"shippingDateBox\", \"ngModel\"], [\"matSuffix\", \"\", 3, \"for\"], [\"picker\", \"\"], [\"matInput\", \"\", \"type\", \"number\", \"name\", \"creditCard\", \"required\", \"\", \"pattern\", \"^(?:4[0-9]{12}(?:[0-9]{3})?|[25][1-7][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\\\\d{3})\\\\d{11})$\", 3, \"ngModel\", \"ngModelChange\"], [\"creditCardBox\", \"ngModel\"], [\"mat-stroked-button\", \"\", 3, \"disabled\"]],\n  template: function MyOrderComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelement(2, \"app-receipt\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 2);\n      i0.ɵɵelementStart(4, \"h3\");\n      i0.ɵɵtext(5, \"My Order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(6, \"hr\");\n      i0.ɵɵelementStart(7, \"span\");\n      i0.ɵɵtext(8, \"Shipping Details\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"form\", 3, 4);\n      i0.ɵɵlistener(\"submit\", function MyOrderComponent_Template_form_submit_9_listener() {\n        return ctx.makeOrder();\n      });\n      i0.ɵɵelementStart(11, \"mat-form-field\", 5);\n      i0.ɵɵelementStart(12, \"mat-label\");\n      i0.ɵɵtext(13, \"City: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"input\", 6, 7);\n      i0.ɵɵlistener(\"ngModelChange\", function MyOrderComponent_Template_input_ngModelChange_14_listener($event) {\n        return ctx.order.city = $event;\n      })(\"dblclick\", function MyOrderComponent_Template_input_dblclick_14_listener() {\n        return ctx.getUsersCity();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(16, MyOrderComponent_mat_error_16_Template, 2, 0, \"mat-error\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"mat-form-field\", 5);\n      i0.ɵɵelementStart(18, \"mat-label\");\n      i0.ɵɵtext(19, \"Street: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"input\", 9, 10);\n      i0.ɵɵlistener(\"ngModelChange\", function MyOrderComponent_Template_input_ngModelChange_20_listener($event) {\n        return ctx.order.st = $event;\n      })(\"dblclick\", function MyOrderComponent_Template_input_dblclick_20_listener() {\n        return ctx.getUsersSt();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(22, MyOrderComponent_mat_error_22_Template, 2, 0, \"mat-error\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"mat-form-field\", 5);\n      i0.ɵɵelementStart(24, \"mat-label\");\n      i0.ɵɵtext(25, \"Shipping Date: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"input\", 11, 12);\n      i0.ɵɵlistener(\"ngModelChange\", function MyOrderComponent_Template_input_ngModelChange_26_listener($event) {\n        return ctx.order.shippingDate = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(28, \"mat-datepicker-toggle\", 13);\n      i0.ɵɵelement(29, \"mat-datepicker\", null, 14);\n      i0.ɵɵtemplate(31, MyOrderComponent_mat_error_31_Template, 2, 0, \"mat-error\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"span\");\n      i0.ɵɵtext(33, \"Payment\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"mat-form-field\", 5);\n      i0.ɵɵelementStart(35, \"mat-label\");\n      i0.ɵɵtext(36, \"Credit Card: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(37, \"input\", 15, 16);\n      i0.ɵɵlistener(\"ngModelChange\", function MyOrderComponent_Template_input_ngModelChange_37_listener($event) {\n        return ctx.order.card = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(39, MyOrderComponent_mat_error_39_Template, 2, 0, \"mat-error\", 8);\n      i0.ɵɵtemplate(40, MyOrderComponent_mat_error_40_Template, 2, 0, \"mat-error\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(41, \"button\", 17);\n      i0.ɵɵelementStart(42, \"mat-icon\");\n      i0.ɵɵtext(43, \"send\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(44, \" Order \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(10);\n\n      const _r1 = i0.ɵɵreference(15);\n\n      const _r3 = i0.ɵɵreference(21);\n\n      const _r5 = i0.ɵɵreference(27);\n\n      const _r6 = i0.ɵɵreference(30);\n\n      const _r8 = i0.ɵɵreference(38);\n\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngModel\", ctx.order.city);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", (_r1.errors == null ? null : _r1.errors.required) && _r1.touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.order.st);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", (_r3.errors == null ? null : _r3.errors.required) && _r3.touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"matDatepickerFilter\", ctx.myFilter)(\"matDatepicker\", _r6)(\"min\", ctx.today)(\"ngModel\", ctx.order.shippingDate);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"for\", _r6);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", (_r5.errors == null ? null : _r5.errors.required) && _r5.touched);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngModel\", ctx.order.card);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", (_r8.errors == null ? null : _r8.errors.required) && _r8.touched);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", (_r8.errors == null ? null : _r8.errors.pattern) && _r8.touched);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", _r0.form.invalid);\n    }\n  },\n  directives: [i7.ReceiptComponent, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i8.NgForm, i9.MatFormField, i9.MatLabel, i10.MatInput, i8.DefaultValueAccessor, i8.RequiredValidator, i8.NgControlStatus, i8.NgModel, i11.NgIf, i12.MatDatepickerInput, i12.MatDatepickerToggle, i9.MatSuffix, i12.MatDatepicker, i8.NumberValueAccessor, i8.PatternValidator, i13.MatButton, i14.MatIcon, i9.MatError],\n  styles: [\"span[_ngcontent-%COMP%] {\\r\\n    float: left;\\r\\n}\\r\\n        \\r\\n.cart[_ngcontent-%COMP%] {\\r\\n    \\r\\n    height: 20px;\\r\\n    text-align: center;\\r\\n    width: 45%;\\r\\n    float: left;\\r\\n}\\r\\n        \\r\\n.order[_ngcontent-%COMP%] {\\r\\n    display: inline-block;\\r\\n    \\r\\n    padding: 0 10px;\\r\\n    margin: 10px;\\r\\n    \\r\\n    \\r\\n}\\r\\n        \\r\\nform[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%] {\\r\\n    width: 300px;\\r\\n}\\r\\n        \\r\\nbutton[_ngcontent-%COMP%] {\\r\\n    width: 50%;\\r\\n    text-align: center;\\r\\n}\\r\\n        \\r\\n.mat-hint[_ngcontent-%COMP%] {\\r\\n    color: red;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm15LW9yZGVyLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxXQUFXO0FBQ2Y7O0FBRUE7SUFDSSwyQkFBMkI7SUFDM0IsWUFBWTtJQUNaLGtCQUFrQjtJQUNsQixVQUFVO0lBQ1YsV0FBVztBQUNmOztBQUVBO0lBQ0kscUJBQXFCO0lBQ3JCLDZCQUE2QjtJQUM3QixlQUFlO0lBQ2YsWUFBWTtJQUNaLHlCQUF5QjtJQUN6Qiw4QkFBOEI7QUFDbEM7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksVUFBVTtJQUNWLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLFVBQVU7QUFDZCIsImZpbGUiOiJteS1vcmRlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsic3BhbiB7XHJcbiAgICBmbG9hdDogbGVmdDtcclxufVxyXG4gICAgICAgIFxyXG4uY2FydCB7XHJcbiAgICAvKiBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7ICovXHJcbiAgICBoZWlnaHQ6IDIwcHg7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICB3aWR0aDogNDUlO1xyXG4gICAgZmxvYXQ6IGxlZnQ7XHJcbn1cclxuXHJcbi5vcmRlciB7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICAvKiBib3JkZXI6IDFweCBzb2xpZCBibGFjazsgKi9cclxuICAgIHBhZGRpbmc6IDAgMTBweDtcclxuICAgIG1hcmdpbjogMTBweDtcclxuICAgIC8qIGJvcmRlci1yYWRpdXM6IDEwcHg7ICovXHJcbiAgICAvKiBib3gtc2hhZG93OiA1cHggNXB4IDEwcHg7ICovXHJcbn1cclxuXHJcbmZvcm0sIG1hdC1mb3JtLWZpZWxkIHtcclxuICAgIHdpZHRoOiAzMDBweDtcclxufVxyXG5cclxuYnV0dG9uIHtcclxuICAgIHdpZHRoOiA1MCU7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbn1cclxuXHJcbi5tYXQtaGludCB7XHJcbiAgICBjb2xvcjogcmVkO1xyXG59Il19 */\"]\n});","map":{"version":3,"sources":["C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\order-area\\my-order\\my-order.component.ts","C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\order-area\\my-order\\my-order.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\nimport { Unsubscribe } from 'redux';\nimport CartModel from 'src/app/models/cart.model';\nimport ItemModel from 'src/app/models/item.model';\nimport OrderModel from 'src/app/models/order.model';\nimport UserModel from 'src/app/models/user.model';\nimport { NotifyService } from 'src/app/services/notify.service';\nimport { OrdersService } from 'src/app/services/orders.service';\nimport store from 'src/app/redux/store';\nimport { CartsService } from 'src/app/services/carts.service';\nimport { ItemsService } from 'src/app/services/items.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport { DialogComponent } from '../dialog/dialog.component';\nimport { Router } from '@angular/router';\n\nexport interface DialogData {\n  quantity: number;\n}\n\n@Component({\n  selector: 'app-my-order',\n  templateUrl: './my-order.component.html',\n  styleUrls: ['./my-order.component.css'],\n})\n\nexport class MyOrderComponent implements OnInit {\n\n  private carts: CartModel[];\n  private items: ItemModel[];\n  public orders: OrderModel[];\n  public user: UserModel;\n  public order = new OrderModel();\n  public cart: CartModel;\n  public totalPrice: number;\n  unsubscribeMe: Unsubscribe;\n  private lastCartIndex: number;\n  public dialogRef: any;\n  public result: any;\n  public today = new Date();\n\n  constructor(\n    private myCartsService: CartsService,\n    private myOrdersService: OrdersService,\n    private myItemsService: ItemsService,\n    private notify: NotifyService,\n    public dialog: MatDialog,\n    private myRouter: Router\n  ) { }\n\n  ngOnInit() {\n    this.unsubscribeMe = store.subscribe(async () => {\n      this.user = store.getState().authState.user;\n      try {\n        this.carts = await this.myCartsService.getAllCarts(this.user._id);\n      }\n      catch (err) {\n          this.notify.error(\"err getting user carts\");\n      }\n      try {\n      this.orders = await this.myOrdersService.getAllOrders();\n      }\n      catch (err) {\n          this.notify.error(\"err getting user carts\");\n      }\n      const takenShippinDate = this.orders.count([\n        {\"$group\" : { \"order\": \"$shippingDate\", \"count\": { \"$sum\": 3 } } },\n        ]);\n      // console.log(takenShippinDate);\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.unsubscribeMe();\n  }\n\n  getUsersCity() {\n    this.order.city=this.user.city;\n  }\n\n  getUsersSt() {\n    // this.user = store.getState().authState.user;\n    this.order.st = this.user.st;\n  }\n\n  myFilter = (d: Date | null): boolean => {\n    const day = (d || new Date()).getDay();\n    \n    \n    return day !== 5 && day !== 6;\n  };\n\n  \n  // counldnt find the right validation for future date only\n  // async dateValidation() {\n    // const myFilter = (d: Date | null): boolean => {\n      // const takenShippinDate = this.orders.count(o.shippingDate === 3);\n      // const day = (d || new Date()).getDay();\n      // Prevent Saturday and Sunday from being selected.\n      // return day !== 5 && day !== 6 && day !== takenShippinDate;\n    // public disabledDates = (date: Date): boolean => {\n    // return date.getDate() % 2 === 0;\n    // };\n    // };\n    \n    // try {\n    //   this.orders = await this.myOrdersService.getAllOrders();\n    // }\n    // catch (err) {\n    //     this.notify.error(err);\n    // }\n    // const takenShippinDate = this.orders.count(o.shippingDate === 3);\n    // \n    // let picker = (d: Date | null): boolean => {\n    //   const day = (d || new Date()).getDay();\n    //   // Prevent Saturday and Sunday from being selected.\n    //   return day !== 0 && day !== 6;\n    // };\n  // }\n  \n\n  // doesn work\n  cardValidation() {\n    const cardRegEx = '/^(?:4[0-9]{12}(?:[0-9]{3})?)$/ || /^(?:5[1-5][0-9]{14})$/ || /^(?:3[47][0-9]{13})$/ || /^(?:6(?:011|5[0-9][0-9])[0-9]{12})$/';\n    if (this.order.card !== cardRegEx) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  async makeOrder() {\n    this.user = store.getState().authState.user;\n    try {\n      this.carts = await this.myCartsService.getAllCarts(this.user._id);\n      console.log(this.carts);\n    }\n    catch (err) {\n        this.notify.error(\"err getting user carts-order page\");\n    }\n    this.order.user = this.user;\n    this.lastCartIndex = this.carts.length - 1;\n    try {\n      this.items = await this.myItemsService.getAllItems(this.carts[this.lastCartIndex]._id);\n    }\n    catch (err) {\n        this.notify.error(\"err getting user carts\");\n    }\n    this.order.cart = this.carts[this.lastCartIndex];\n    for (let item of this.items) {\n      this.totalPrice += item.price;\n    }\n    this.order.price = 2000;\n    this.order.orderDate = new Date().toLocaleDateString();\n    console.log(this.order.orderDate);\n    this.order.card = this.order.card.toString();\n    try {\n      this.order = await this.myOrdersService.addOrder(this.order);\n      this.order.card = this.order.card.substring(this.order.card.length - 4);\n    }\n    catch (err) {\n      this.notify.error(\"problem creating order\");\n    }\n    console.log(this.order);\n    this.dialogRef = this.dialog.open(DialogComponent, {\n      data: {invoice: this.cart},\n    });\n    this.dialogRef.afterClosed().subscribe((result: any) => {\n      console.log('The dialog was closed');\n      this.myRouter.navigateByUrl(\"/home\");\n      this.result = result;\n    });\n  }\n}\n\n","<div calss=\"main\">\n    <div class=\"cart\">\n        <app-receipt></app-receipt>\n    </div>\n    <div class=\"order\">\n        <h3>My Order</h3>\n        <hr/>\n        <span>Shipping Details</span>\n        <form #myForm=\"ngForm\" (submit)=\"makeOrder()\">\n\n            <mat-form-field appearance=\"fill\">\n                <mat-label>City: </mat-label>\n                <input matInput #cityBox=\"ngModel\" type=\"text\" name=\"city\" [(ngModel)]=\"order.city\" required (dblclick)=\"getUsersCity()\">\n                <mat-error *ngIf=\"cityBox.errors?.required && cityBox.touched\">Missing city.</mat-error>\n            </mat-form-field>\n    \n            <mat-form-field appearance=\"fill\">\n                <mat-label>Street: </mat-label>\n                <input matInput #stBox=\"ngModel\" type=\"text\" name=\"st\" [(ngModel)]=\"order.st\" required (dblclick)=\"getUsersSt()\"/>\n                <mat-error *ngIf=\"stBox.errors?.required && stBox.touched\">Missing street.</mat-error>\n            </mat-form-field>\n\n            <mat-form-field appearance=\"fill\">\n                <mat-label>Shipping Date: </mat-label>\n                <input matInput [matDatepickerFilter]=\"myFilter\" [matDatepicker]=\"picker\" #shippingDateBox=\"ngModel\" [min]=\"today\" name=\"shippingDate\" [(ngModel)]=\"order.shippingDate\" required>\n                <mat-datepicker-toggle matSuffix [for]=\"picker\"></mat-datepicker-toggle>\n                <mat-datepicker #picker></mat-datepicker>\n                <mat-error *ngIf=\"shippingDateBox.errors?.required && shippingDateBox.touched\">Missing shipping date.</mat-error>\n                <!-- <mat-hint *ngIf=\"dateValidation()\">Sorry, this shipping date is allready full</mat-hint>   -->\n            </mat-form-field>\n\n            <span>Payment</span>\n            <mat-form-field appearance=\"fill\">\n                <mat-label>Credit Card: </mat-label>\n                <input matInput #creditCardBox=\"ngModel\" type=\"number\" name=\"creditCard\" [(ngModel)]=\"order.card\" required pattern=\"^(?:4[0-9]{12}(?:[0-9]{3})?|[25][1-7][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\\d{3})\\d{11})$\"/>\n                <mat-error *ngIf=\"creditCardBox.errors?.required && creditCardBox.touched\">Missing credit card number.</mat-error>\n                <mat-error *ngIf=\"creditCardBox.errors?.pattern && creditCardBox.touched\">This is not a valid credit card</mat-error>\n            </mat-form-field>\n\n            <button mat-stroked-button [disabled]=\"myForm.form.invalid\">\n                <mat-icon>send</mat-icon>\n                Order\n            </button>\n\n        </form>\n    </div>\n</div>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}