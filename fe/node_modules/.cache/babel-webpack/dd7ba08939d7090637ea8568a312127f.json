{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/Desktop/FullStack/JB/Third Project/fe/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport ProductModel from 'src/app/models/product.model';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { environment } from 'src/environments/environment';\nlet AdminComponent = class AdminComponent {\n  constructor(myProductsService, myActivatedRoute, myCategoriesService, notify, myRouter) {\n    this.myProductsService = myProductsService;\n    this.myActivatedRoute = myActivatedRoute;\n    this.myCategoriesService = myCategoriesService;\n    this.notify = notify;\n    this.myRouter = myRouter;\n    this.product = new ProductModel();\n    this.imageUrl = environment.productImagesUrl;\n    this.nameControl = new FormControl(null, [Validators.required, Validators.pattern(\"^[A-Z].*$\")]);\n    this.priceControl = new FormControl(null, Validators.required);\n    this.categoryControl = new FormControl(null, Validators.required);\n    this.imageControl = new FormControl();\n    this.productForm = new FormGroup({\n      nameControl: this.nameControl,\n      priceControl: this.priceControl,\n      categoryControl: this.categoryControl,\n      imageControl: this.imageControl\n    });\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // this.unsubscribeMe = store.subscribe(async() => {\n      //   this.user = store.getState().authState.user;\n      //   console.log(this.user);\n      try {\n        _this.products = yield _this.myProductsService.getAllProducts();\n      } catch (err) {\n        console.log(\"cant get products\");\n      }\n\n      try {\n        _this.categories = yield _this.myCategoriesService.getAllCategories();\n      } catch (err) {\n        console.log(\"cant get categories\");\n      } // });\n\n    })();\n  } // ngOnDestroy(): void {\n  //   this.unsubscribeMe();\n  // }\n\n\n  saveImage(args) {\n    this.product.image = args.target.files;\n  }\n\n  getThisProduct(p) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.nameControl.setValue(p.name);\n\n      _this2.priceControl.setValue(p.price);\n\n      _this2.categoryControl.setValue(p.category);\n\n      _this2.myRouter.navigateByUrl(\"/admin/\" + p._id);\n    })();\n  }\n\n  edit() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const id = _this3.myActivatedRoute.snapshot.params.id;\n        _this3.product._id = id;\n        _this3.product.name = _this3.nameControl.value;\n        _this3.product.price = _this3.priceControl.value;\n\n        for (_this3.category of _this3.categories) {\n          _this3.product.categoryToSend === _this3.categoryControl.value;\n        }\n\n        _this3.product.categoryToSend = _this3.category._id;\n        console.log(_this3.product.categoryToSend);\n        yield _this3.myProductsService.editProduct(_this3.product);\n\n        _this3.notify.success(\"Product has been updated.\");\n      } catch (err) {\n        console.log(\"problem editing product\");\n      }\n    })();\n  }\n\n  refresh() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        _this4.categories = yield _this4.myCategoriesService.getAllCategories();\n      } catch (err) {\n        console.log(\"cant get categories\");\n      }\n\n      try {\n        const id = _this4.myActivatedRoute.snapshot.params.id; // Take a route parameter named id\n\n        _this4.category = yield _this4.myCategoriesService.getOneCategory(id);\n      } catch (err) {\n        _this4.notify.error(err);\n      }\n    })();\n  }\n\n};\nAdminComponent = __decorate([Component({\n  selector: 'app-admin',\n  templateUrl: './admin.component.html',\n  styleUrls: ['./admin.component.css'],\n  styles: []\n})], AdminComponent);\nexport { AdminComponent };","map":{"version":3,"sources":["C:\\Users\\user\\Desktop\\FullStack\\JB\\Third Project\\fe\\src\\app\\components\\admin-area\\admin\\admin.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport ProductModel from 'src/app/models/product.model';\nimport { NotifyService } from 'src/app/services/notify.service';\nimport { CategoryService } from 'src/app/services/category.service';\nimport CategoryModel from 'src/app/models/category.model';\nimport UserModel from 'src/app/models/user.model';\nimport { Unsubscribe } from 'redux';\nimport store from 'src/app/redux/store';\nimport { ProductsService } from 'src/app/services/products.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { environment } from 'src/environments/environment';\n\n@Component({\n  selector: 'app-admin',\n  templateUrl: './admin.component.html',\n  styleUrls: ['./admin.component.css']\n})\nexport class AdminComponent implements OnInit {\n\n  public products: ProductModel[];\n  public product = new ProductModel();\n  public categories: CategoryModel[];\n  public category: CategoryModel;\n  public user: UserModel;\n  private unsubscribeMe: Unsubscribe;\n  public imageUrl = environment.productImagesUrl;\n\n  // FormGroup is an object representing the <form> element: \n  public productForm: FormGroup;\n\n  // FormControl is an object representing an <input>/<select>/<textarea> element:\n  public nameControl: FormControl;\n  public priceControl: FormControl;\n  public categoryControl: FormControl;\n  public imageControl: FormControl;\n\n  constructor(\n    private myProductsService: ProductsService,\n    private myActivatedRoute: ActivatedRoute,\n    private myCategoriesService: CategoryService,\n    private notify: NotifyService,\n    private myRouter: Router) {\n\n      this.nameControl = new FormControl(null, [Validators.required, Validators.pattern(\"^[A-Z].*$\")]);\n      this.priceControl = new FormControl(null, Validators.required);\n      this.categoryControl = new FormControl(null, Validators.required);\n      this.imageControl = new FormControl();\n      this.productForm = new FormGroup({\n          nameControl: this.nameControl,\n          priceControl: this.priceControl,\n          categoryControl: this.categoryControl,\n          imageControl: this.imageControl\n      });\n    }\n\n  async ngOnInit() {\n    // this.unsubscribeMe = store.subscribe(async() => {\n    //   this.user = store.getState().authState.user;\n    //   console.log(this.user);\n    try {\n      this.products = await this.myProductsService.getAllProducts();\n    }\n    catch (err) {\n      console.log(\"cant get products\");\n    }\n    try {\n      this.categories = await this.myCategoriesService.getAllCategories();\n    }\n    catch (err) {\n      console.log(\"cant get categories\");\n    }\n    // });\n  }\n\n  // ngOnDestroy(): void {\n  //   this.unsubscribeMe();\n  // }\n\n  public saveImage(args: Event): void {\n    this.product.image = (args.target as HTMLInputElement).files;\n  }\n\n  public async getThisProduct(p: ProductModel) {\n    this.nameControl.setValue(p.name);\n    this.priceControl.setValue(p.price);\n    this.categoryControl.setValue(p.category);\n    this.myRouter.navigateByUrl(\"/admin/\"+ p._id);\n  }\n\n  public async edit() {\n    try {\n      const id = this.myActivatedRoute.snapshot.params.id;\n      this.product._id = id;\n      this.product.name = this.nameControl.value;\n      this.product.price = this.priceControl.value;\n      for (this.category of this.categories) {\n        this.product.categoryToSend === this.categoryControl.value;\n      }\n      this.product.categoryToSend = this.category._id;\n      console.log(this.product.categoryToSend);\n      await this.myProductsService.editProduct(this.product);\n      this.notify.success(\"Product has been updated.\");\n    }\n    catch(err) {\n        console.log(\"problem editing product\");\n    }\n  }\n\n  async refresh() {\n    try {\n      this.categories = await this.myCategoriesService.getAllCategories();\n    }\n    catch (err) {\n      console.log(\"cant get categories\");\n    }\n    try {\n      const id = this.myActivatedRoute.snapshot.params.id; // Take a route parameter named id\n      this.category = await this.myCategoriesService.getOneCategory(id);\n    }\n    catch (err) {\n      this.notify.error(err);\n    }\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}